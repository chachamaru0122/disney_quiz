<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DisneyQAã®å•é¡Œä¾‹</title>

<style>
body {
  font-family: "Hiragino Maru Gothic ProN", sans-serif;
  background: linear-gradient(180deg, #ffd6e8, #fff3b0);
  text-align: center;
  padding: 20px;
}

h1 {
  color: #ff6f91;
}

button {
  width: 100%;
  padding: 14px;
  margin: 10px 0;
  font-size: 16px;
  border-radius: 30px;
  border: none;
  background: white;
}

.correct { color: #ff6f91; font-weight: bold; }
.wrong { color: #5f6caf; font-weight: bold; }

.hidden { display: none; }

#loading {
  margin-top: 30px;
  color: #ff6f91;
  font-weight: bold;
}
</style>
</head>

<body>

<h1>ğŸ°DisneyQAã®å•é¡ŒğŸ°</h1>

<div id="start">
  <button onclick="startQuiz()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
</div>

<div id="quiz" class="hidden"></div>
<div id="feedback" class="hidden"></div>

<!-- é›†è¨ˆä¸­è¡¨ç¤º -->
<div id="loading" class="hidden">
  <h2>ğŸ“Š çµæœã‚’é›†è¨ˆä¸­â€¦</h2>
  <p id="countdown">å°‘ã€…ãŠå¾…ã¡ãã ã•ã„</p>
</div>

<div id="result" class="hidden"></div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw6V-EN8h-zNgAOKfb5jmr1cHvUOQrWzS6jVQmH8FRmZPy1mzvLD2k-jHHv2XUvl5TI/exec";

const quiz = [
  {
    author: "äººé–“",
    q: "æ±äº¬ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ©ãƒ³ãƒ‰ã®ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒ©ãƒ³ã‚¹ã®å»ºç¯‰æ§˜å¼ã¯ï¼Ÿ",
    c: ["ãƒãƒ¥ãƒ¼ãƒ€ãƒ¼æœæ§˜å¼","ã‚¹ãƒãƒ¥ã‚¢ãƒ¼ãƒˆæ§˜å¼","ã‚¸ãƒ§ãƒ¼ã‚¸ç‹æœæ§˜å¼","ãƒ´ã‚£ã‚¯ãƒˆãƒªã‚¢æœæ§˜å¼"],
    a: 3
  },
  {
    author: "ChatGPT",
    q: "æ˜ ç”»ã€ã‚ºãƒ¼ãƒˆãƒ”ã‚¢ã€ã§ã€ãƒ‹ãƒƒã‚¯ãŒå­ã©ã‚‚ã®é ƒã«ç€ã¦ã„ãŸãƒœãƒ¼ã‚¤ã‚¹ã‚«ã‚¦ãƒˆã®è¡£è£…ã®è‰²ã¯ï¼Ÿ",
    c: ["ç·‘","é’","èµ¤","é»„è‰²"],
    a: 0
  },
  {
    author: "Gemini3",
    q: "ã‚¦ã‚©ãƒ«ãƒˆãƒ»ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ»ãƒ¯ãƒ¼ãƒ«ãƒ‰ï¼ˆãƒ•ãƒ­ãƒªãƒ€ï¼‰ã®åœ°ä¸‹ã«ã‚ã‚‹åºƒå¤§ãªãƒˆãƒ³ãƒãƒ«ã€Œãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ‰ãƒ¼ãƒ«ã€ã€‚ã‚¦ã‚©ãƒ«ãƒˆãŒã“ã‚Œã‚’ä½œã‚‹æ±ºæ„ã‚’ã—ãŸã€Œãã£ã‹ã‘ã€ã¯ä½•ã§ã™ã‹ï¼Ÿ",
    c: ["çªç„¶ã®è±ªé›¨ã‹ã‚‰ã‚­ãƒ£ã‚¹ãƒˆã‚’å®ˆã‚‹ãŸã‚","ã‚¹ã‚¿ãƒƒãƒ•å°‚ç”¨ã®é§è»Šå ´ã‚’ä½œã‚‹ãŸã‚","ã‚´ãƒŸã®å›åã‚’ã‚²ã‚¹ãƒˆã«è¦‹ã›ãªã„ãŸã‚","ãƒˆã‚¥ãƒ¢ãƒ­ãƒ¼ãƒ©ãƒ³ãƒ‰ã«ã‚«ã‚¦ãƒœãƒ¼ã‚¤ãŒã„ã‚‹ã®ã‚’è¦‹ãŸã‹ã‚‰"],
    a: 3
  },
  {
    author: "Claude-Sonnet4.5",
    q: "æ±äº¬ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ©ãƒ³ãƒ‰ã®ã€Œãƒ›ãƒ¼ãƒ³ãƒ†ãƒƒãƒ‰ãƒãƒ³ã‚·ãƒ§ãƒ³ã€ã«ç™»å ´ã™ã‚‹ã€Œ999äººã®äº¡éœŠã€ã®ã†ã¡ã€ã‚ã¨ä½•äººã§1000äººã«ãªã‚‹ã¨è¨€ã‚ã‚Œã¦ã„ã‚‹ï¼Ÿ",
    c: ["ã‚ãªãŸï¼ˆã‚²ã‚¹ãƒˆï¼‰","ã‚‚ã†1000äººã«é”ã—ã¦ã„ã‚‹","ã¾ã å‹Ÿé›†ä¸­","ã‚«ã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ãªã„"],
    a: 0
  }
];


let current = 0;
let answers = [];

function startQuiz() {
  document.getElementById("start").classList.add("hidden");
  document.getElementById("quiz").classList.remove("hidden");
  showQuestion();
}

function showQuestion() {
  const q = quiz[current];
  let html = `<h2>${q.q}</h2>`;
  q.c.forEach((c,i)=>{
    html += `<button onclick="selectAnswer(${i})">${c}</button>`;
  });
  document.getElementById("quiz").innerHTML = html;
}

function selectAnswer(i) {
  const correct = quiz[current].a;
  answers[current] = (i === correct);

  document.getElementById("quiz").classList.add("hidden");
  document.getElementById("feedback").classList.remove("hidden");

  document.getElementById("feedback").innerHTML = `
    <p class="${i === correct ? 'correct' : 'wrong'}">
      ${i === correct ? 'â­• æ­£è§£ï¼' : 'âŒ ä¸æ­£è§£'}
    </p>
    <p>æ­£è§£ï¼š${quiz[current].c[correct]}</p>
    <button onclick="nextQuestion()">æ¬¡ã¸</button>
  `;
}

function nextQuestion() {
  current++;
  document.getElementById("feedback").classList.add("hidden");

  if (current < quiz.length) {
    document.getElementById("quiz").classList.remove("hidden");
    showQuestion();
  } else {
    sendResult();
  }
}

function sendResult() {
  const score = answers.filter(a => a).length;

  // é›†è¨ˆä¸­è¡¨ç¤º
  document.getElementById("loading").classList.remove("hidden");

  let seconds = 3;
  const countdownEl = document.getElementById("countdown");
  countdownEl.textContent = `çµæœè¡¨ç¤ºã¾ã§ ${seconds} ç§’â€¦`;

  const timer = setInterval(() => {
    seconds--;
    if (seconds > 0) {
      countdownEl.textContent = `çµæœè¡¨ç¤ºã¾ã§ ${seconds} ç§’â€¦`;
    }
  }, 1000);

  fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({
      score,
      q1: answers[0],
      q2: answers[1],
      q3: answers[2],
      q4: answers[3]
    })
  }).then(() => {
    clearInterval(timer);
    showResult();
  });
}

function showResult() {
  document.getElementById("loading").classList.add("hidden");

  fetch(SCRIPT_URL)
    .then(res => res.json())
    .then(data => {

      const myResults = answers.map(a => a ? "â­•" : "âŒ");
      const myScore = answers.filter(a => a).length;
      const total = data.totalUsers || 0;

      const rates = data.correct.map(c =>
        total > 0 ? Math.round((c / total) * 100) : 0
      );

      document.getElementById("result").classList.remove("hidden");

      document.getElementById("result").innerHTML = `
        <h2>ğŸ€ çµæœ ğŸ€</h2>

        <h3>ã‚ãªãŸã®çµæœ</h3>
        <ul style="list-style:none; padding:0;">
          <li>Q1(äººé–“)ï¼š${myResults[0]}</li>
          <li>Q2(ChatGPT)ï¼š${myResults[1]}</li>
          <li>Q3(Gemini3)ï¼š${myResults[2]}</li>
          <li>Q4(Claude-Sonnet4,5)ï¼š${myResults[3]}</li>
        </ul>

        <p><strong>æ­£ç­”æ•°ï¼š</strong>${myScore} / 4</p>

        <hr>

        <h3>ã¿ã‚“ãªã®çµæœ</h3>
        <p>ğŸ‘¤ è§£ã„ãŸäººæ•°ï¼š${total} äºº</p>

        <ul style="list-style:none; padding:0;">
          <li>Q1(äººé–“) æ­£ç­”ç‡ï¼š${rates[0]}%</li>
          <li>Q2(ChatGPT) æ­£ç­”ç‡ï¼š${rates[1]}%</li>
          <li>Q3(Gemini3) æ­£ç­”ç‡ï¼š${rates[2]}%</li>
          <li>Q4(Claude-Sonnet4.5) æ­£ç­”ç‡ï¼š${rates[3]}%</li>
        </ul>
      `;
    })
    .catch(err => {
      document.getElementById("result").classList.remove("hidden");
      document.getElementById("result").innerHTML = `
        <h2>âš ï¸ çµæœã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ</h2>
        <p>Apps Script ã¨ã®é€šä¿¡ã«å¤±æ•—ã—ã¦ã„ã¾ã™</p>
      `;
      console.error(err);
    });
}
</script>

</body>
</html>
